{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\nconst urlBase = 'http://api.tvmaze.com/search/shows?q=';\nconst ulElem = document.querySelector('.tvShows-list');\nconst favElem = document.querySelector('#favouritesList');\nconst inputValue = document.querySelector('.searchInput');\nconst searchButton = document.querySelector('.buttonSearch');\n\nlet tvShowsList = [];\nconst favourites = readLocalStorage();\n\n//1.Función llamar a la Api\n\nfunction conectToApi() {\n  const inputName = inputValue.value;\n  ulElem.innerHTML = '';\n\n  fetch(`${urlBase}` + inputName)\n    .then(response => response.json())\n    .then(data => {\n      tvShowsList = data;\n      renderTvShows(tvShowsList);\n      renderFavourites(favourites);\n    });\n}\n\n//2.Función pintar la película (añadimos ID para comprobar luego que no la tenemos si ya la hemos añadido a favoritos)\n\nfunction renderTvShows(tvShowsArr) {\n  for (let item of tvShowsArr) {\n    if (item.show.image !== null) {\n      ulElem.innerHTML += `<li id='${item.show.id}' class='tvShow-list_item'><img src='${item.show.image.medium}' alt='Poster'</img><p class='show-title'>${item.show.name}</p></li>`;\n    } else {\n      ulElem.innerHTML += `<li id='${item.show.id}' class='tvShow-list_item'><img src='https://via.placeholder.com/210x295/ffffff/666666/?text=TV' alt='Poster'</img><p class='show-title'>${item.show.name}</p></li>`;\n    }\n    addClickListeners();\n  }\n}\n\n//3.Función para añadir listener a los li para guardar en favoritos. La ejecutamos donde pinta las películas, es decir en el paso 2.\n\nfunction addClickListeners() {\n  const tvShowLiElements = document.querySelectorAll('.tvShow-list_item');\n\n  for (let tvShowLi of tvShowLiElements) {\n    tvShowLi.addEventListener('click', saveFavourites);\n  }\n}\n\n//4.Función que setea el LocalStorage.\n\nfunction setLocalStorage(favourites) {\n  localStorage.setItem('tvShowInfo', JSON.stringify(favourites));\n  // meter por cada indice su id y su valor, en local storage para que carguen con todas las busquedas\n}\n\n//5.Función que recoge el valor de LocalStorage, lee y parsea la info.\n\nfunction readLocalStorage() {\n  let localInfo = JSON.parse(localStorage.getItem('tvShowInfo'));\n  if (localInfo !== null) {\n    return localInfo;\n  } else {\n    return (localInfo = []);\n  }\n}\n\n//6. Función que guarda favoritos al hacer click.\n\nfunction saveFavourites(evt) {\n  const index = parseInt(evt.currentTarget.id);\n\n  if (favourites.indexOf(index) === -1) {\n    favourites.push(index);\n    setLocalStorage(favourites);\n    renderFavourites(favourites);\n  } else {\n    alert('Ya has añadido esta serie a favoritos');\n  }\n}\n\n//7.Función que relaciona el favorito con su ID ,lo lee y devuelve el objeto para pintar en favoritos.\n\nfunction getTvShowObject(idTvShow) {\n  for (let item of tvShowsList) {\n    if (item.show.id === idTvShow) {\n      return item;\n    }\n  }\n}\n\n//8.Función que nos pinta el contenido de favoritos.\n\nfunction renderFavourites(favouritesArr) {\n  favElem.innerHTML = '';\n  for (let favourite of favouritesArr) {\n    let tvShowObject = getTvShowObject(favourite);\n\n    if (tvShowObject) {\n      favElem.innerHTML += `<li id=${tvShowObject.show.id}><img src='${tvShowObject.show.image.medium}' alt='Poster'</img><p>${tvShowObject.show.name}</p><button type=\"button\">Borrar</button></li>`;\n    }\n  }\n}\n\nsearchButton.addEventListener('click', conectToApi);\n"]}