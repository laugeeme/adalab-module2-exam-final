{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\nconst urlBase = 'http://api.tvmaze.com/search/shows?q=';\nconst ulElem = document.querySelector('.tvShows-list');\nconst favElem = document.querySelector('#favouritesList');\nconst inputValue = document.querySelector('.searchInput');\nconst searchButton = document.querySelector('.buttonSearch');\nconst deleteButton = document.querySelector('.delete-all_button');\n\nlet tvShowsList = [];\nlet localStorageFavourites = readLocalStorage();\n\n//1.Function to conect to Api.\nfunction conectToApi() {\n  const inputName = inputValue.value;\n  ulElem.innerHTML = '';\n\n  fetch(`${urlBase}` + inputName)\n    .then(response => response.json())\n    .then(data => {\n      tvShowsList = data;\n      printTvShows(tvShowsList);\n    });\n}\n\nfunction conectToApiIfEnter(evt) {\n  if (evt.keyCode === 13) {\n    conectToApi();\n  }\n}\n\n//2.Function to print results from search (add item.show.id to compare if we don't have in favourites).\nfunction printTvShows(tvShowsArr) {\n  for (let item of tvShowsArr) {\n    const liElem = document.createElement('li');\n    liElem.setAttribute('id', item.show.id);\n    liElem.setAttribute('class', 'tvShow-list_item');\n\n    const imgElem = document.createElement('img');\n    imgElem.setAttribute('alt', 'Poster');\n\n    const pElem = document.createElement('p');\n    pElem.setAttribute('class', 'show-title');\n    let pContent = document.createTextNode(item.show.name);\n\n    pElem.appendChild(pContent);\n    liElem.appendChild(imgElem);\n    liElem.appendChild(pElem);\n    ulElem.appendChild(liElem);\n\n    if (item.show.image !== null) {\n      imgElem.setAttribute('src', item.show.image.medium);\n    } else {\n      imgElem.setAttribute(\n        'src',\n        'https://via.placeholder.com/210x295/575352/ffffff/?text=TV'\n      );\n    }\n\n    if (obtainIndexOfLocalStorageFavouritesById(item.show.id) !== -1) {\n      liElem.setAttribute('class', 'tvShow-list_item tvShowSelected'); //add class to show favoritedstyle in every search if favorited\n    }\n  }\n  addClickListeners();\n}\n\n//3.Function to obtain the index from localStorageFavourites by his ID\nfunction obtainIndexOfLocalStorageFavouritesById(id) {\n  for (let i = 0; i < localStorageFavourites.length; i++) {\n    if (parseInt(id) === localStorageFavourites[i].show.id) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n//4.Function to add listener to LI to save in favorites. Is ejecuted when the tvshows are printed.\nfunction addClickListeners() {\n  const tvShowLiElements = document.querySelectorAll('.tvShow-list_item');\n\n  for (let tvShowLi of tvShowLiElements) {\n    tvShowLi.addEventListener('click', saveAndDeleteFavourites);\n  }\n}\n\n//5.Function to set the LocalStorage.\nfunction setLocalStorage(favouritesArray) {\n  localStorage.setItem('tvShowInfo', JSON.stringify(favouritesArray));\n}\n\n//6.Function to take the LocalStorage value, read and parse the info.\nfunction readLocalStorage() {\n  let localInfo = JSON.parse(localStorage.getItem('tvShowInfo'));\n  if (localInfo !== null) {\n    return localInfo;\n  }\n  return [];\n}\n\n//7.Function that relates the favorite with is ID, read and brings back the objetc to use it.\nfunction getTvShowObject(id) {\n  return tvShowsList.find(tvShow => tvShow.show.id === parseInt(id));\n}\n\n//8.Function that saves and delete favourites as an object when click.\nfunction saveAndDeleteFavourites(evt) {\n  const id = evt.currentTarget.id;\n  const favoriteObject = getTvShowObject(id);\n  let favouriteIndex = obtainIndexOfLocalStorageFavouritesById(id);\n\n  if (favouriteIndex === -1) {\n    localStorageFavourites.push(favoriteObject);\n    tvShowSelectedStyle(id);\n  } else {\n    deleteFavouriteById(id);\n  }\n\n  setLocalStorage(localStorageFavourites);\n  renderFavourites(localStorageFavourites);\n}\n\n//9.Function who gives or not style at the tvShow favorited.\nfunction tvShowSelectedStyle(id) {\n  const liSelected = document.getElementById(id);\n  liSelected.classList.toggle('tvShowSelected');\n}\n\n//10.Function for print favourites in aside content.\nfunction renderFavourites(favouritesArr) {\n  favElem.innerHTML = '';\n  for (let favouriteItem of favouritesArr) {\n    const liElem = document.createElement('li');\n    liElem.setAttribute('id', favouriteItem.show.id);\n    liElem.setAttribute('class', 'fav-list_item');\n\n    const imgElem = document.createElement('img');\n    imgElem.setAttribute('alt', 'Poster');\n\n    const pElem = document.createElement('p');\n    let pContent = document.createTextNode(favouriteItem.show.name);\n    pElem.appendChild(pContent);\n\n    const spanElem = document.createElement('span');\n    spanElem.setAttribute('class', 'close');\n    spanElem.innerHTML = ' &times;';\n\n    pElem.appendChild(spanElem);\n    liElem.appendChild(imgElem);\n    liElem.appendChild(pElem);\n    favElem.appendChild(liElem);\n\n    if (favouriteItem.show.image !== null) {\n      imgElem.setAttribute('src', favouriteItem.show.image.medium);\n    } else {\n      imgElem.setAttribute(\n        'src',\n        'https://via.placeholder.com/210x295/575352/ffffff/?text=TV'\n      );\n    }\n    addRemoveFavouriteListeners();\n  }\n}\n//11.Add button CLOSE to delete favourites from aside content.\nfunction addRemoveFavouriteListeners() {\n  const closeButtons = document.getElementsByClassName('close');\n  for (let closeButton of closeButtons) {\n    closeButton.addEventListener('click', deleteFavouriteAside);\n  }\n}\n\n//12.Functions to delete favourite from aside. We call to parentElement from CLOSE and we declare the object to looking for the ID and their INDEX.\nfunction deleteFavouriteAside(evt) {\n  const favouriteId = evt.currentTarget.parentElement.parentElement.id;\n  deleteFavouriteById(favouriteId);\n}\n\nfunction deleteFavouriteById(id) {\n  const favouriteIndex = obtainIndexOfLocalStorageFavouritesById(id);\n  localStorageFavourites.splice(favouriteIndex, 1);\n\n  tvShowSelectedStyle(id);\n  setLocalStorage(localStorageFavourites);\n  renderFavourites(localStorageFavourites);\n}\n\n//13.Function to delete all favourites at the same time.\nfunction deleteAllFavourites() {\n  for (let localStorageFavourite of localStorageFavourites) {\n    tvShowSelectedStyle(localStorageFavourite.show.id);\n  }\n\n  favElem.innerHTML = '';\n  setLocalStorage([]);\n  localStorageFavourites = readLocalStorage();\n}\n\nsearchButton.addEventListener('click', conectToApi);\ndocument.addEventListener('keydown', conectToApiIfEnter);\nwindow.addEventListener('load', renderFavourites(localStorageFavourites));\ndeleteButton.addEventListener('click', deleteAllFavourites);\n"]}